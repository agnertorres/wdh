"use strict";function reloadPage(){addNotesToTable(notes),calculateTotalWorkedAllTheTime(notes)}function changeTab(a){for(var b=document.getElementById("note-content"),c=document.getElementById("new-note-content"),d=(document.getElementById("report-content"),0);d<tabItens.length;d++)tabItens[d].classList.remove("active-tab");switch(a.classList.add("active-tab"),a.getAttribute("id")){case"note-item":b.classList.remove("hide"),c.classList.add("hide"),reloadPage();break;case"new-note-item":c.classList.remove("hide"),b.classList.add("hide")}}function zeroLeft(a){return a<10?"0"+a:a}function formatDate(a){var b=a.split("-"),c=new Date(b[0],b[1]-1,b[2]),d=c.getDate(),e=c.getMonth()+1,f=c.getFullYear(),g="";return d<10&&(d="0"+d),e<10&&(e="0"+e),g=d+"/"+e+"/"+f}function calculateTotalWorkedInDay(a,b,c,d){var e=a.split(":"),f=b.split(":"),g=c.split(":"),h=d.split(":"),i=parseInt(f[0],10)-parseInt(e[0],10),j=parseInt(f[1],10)-parseInt(f[1],10),k=parseInt(h[0],10)-parseInt(g[0],10),l=parseInt(h[1],10)-parseInt(g[1],10);j<0&&(j+=60,i-=1),l<0&&(l+=60,k-=1);var m=i+k,n=j+l,o=zeroLeft(m)+":"+zeroLeft(n);return o}function editNote(a){for(var b=document.getElementById("edit-note-form"),c=a.parentNode.parentNode.getAttribute("data-unique-id"),d=document.getElementById("edit-note-date-title"),e=(document.getElementById("edit-note-btn"),{}),f=0;f<notes.length;f++)if(notes[f].id==c){e=notes[f];break}d.innerHTML=e.date,b.editNoteDate.value=e.date,b.editFirstEntry.value=e.firstEntry,b.editFirstExit.value=e.firstExit,b.editSecondEntry.value=e.secondEntry,b.editSecondExit.value=e.secondExit,saveEditedNoteBtn.addEventListener("click",function(){isEmpty(b.editNoteDate.value)||isEmpty(b.editFirstEntry.value)||isEmpty(b.editFirstExit.value)||isEmpty(b.editSecondEntry.value)||isEmpty(b.editSecondExit.value)?alert("Todos os campos são obrigatórios."):isValidHour(b.editFirstEntry.value)&&isValidHour(b.editFirstExit.value)&&isValidHour(b.editSecondEntry.value)&&isValidHour(b.editSecondExit.value)?saveEditedNote(c):alert("Informe apenas horas válidas (hh:mm)")}),toogleEditContent(),reloadPage()}function removeNote(a){for(var b=a.parentNode.parentNode.getAttribute("data-unique-id"),c=0;c<notes.length;c++)if(notes[c].id==b&&window.confirm("Você realmente remover o registro na data "+formatDate(notes[c].date)+" ?")){notes.splice(c,1),localStorage.setItem("notes",JSON.stringify(notes)),addNotesToTable();break}reloadPage()}function addNotesToTable(a){a||(a=JSON.parse(localStorage.getItem("notes"))||[]),noteTableBody.innerHTML="";for(var b=0;b<a.length;b++){var c=document.createElement("tr"),d=document.createAttribute("data-unique-id"),e=document.createElement("td"),f=document.createElement("td"),g=document.createElement("td"),h=document.createElement("td"),i=document.createElement("td"),j=document.createElement("td"),k=document.createElement("td"),l=document.createElement("input"),m=document.createElement("input");d.value=a[b].id,c.setAttributeNode(d),l.type="button",l.value="Editar",l.classList="btn btn-primary h-margin-5",l.addEventListener("click",function(){editNote(this)}),m.type="button",m.value="Remover",m.classList="btn btn-danger h-margin-5",m.addEventListener("click",function(){removeNote(this)}),e.appendChild(document.createTextNode(formatDate(a[b].date))),f.appendChild(document.createTextNode(a[b].firstEntry)),g.appendChild(document.createTextNode(a[b].firstExit)),h.appendChild(document.createTextNode(a[b].secondEntry)),i.appendChild(document.createTextNode(a[b].secondExit)),j.appendChild(document.createTextNode(a[b].total)),k.appendChild(l),k.appendChild(m),c.appendChild(e),c.appendChild(f),c.appendChild(g),c.appendChild(h),c.appendChild(i),c.appendChild(j),c.appendChild(k),noteTableBody.appendChild(c)}}function saveEditedNote(a){for(var b=document.getElementById("edit-note-form"),c=b.editNoteDate.value,d=c.split("-"),e=new Date(d[0],parseInt(d[1])-1,d[2]),f=0;f<notes.length;f++)if(notes[f].id===a){notes[f].date=b.editNoteDate.value,notes[f].dataString=e,notes[f].firstEntry=b.editFirstEntry.value,notes[f].firstExit=b.editFirstExit.value,notes[f].secondEntry=b.editSecondEntry.value,notes[f].secondExit=b.editSecondExit.value,notes[f].total=calculateTotalWorkedInDay(b.editFirstEntry.value,b.editFirstExit.value,b.editSecondEntry.value,b.editSecondExit.value);break}localStorage.setItem("notes",JSON.stringify(notes)),alert("Registro editado com sucesso!"),toogleEditContent(),reloadPage()}function toogleEditContent(){var a=document.getElementsByClassName("content")[0],b=document.getElementsByClassName("edit-note")[0];b.classList.contains("hide")?(b.classList.remove("hide"),a.classList.add("hide")):(b.classList.add("hide"),a.classList.remove("hide"))}function calculateTotalWorkedAllTheTime(a){totalWorkedHours.innerHTML="";for(var b,c=0,d=0,e=0;e<a.length;e++){var f=a[e].total.split(":");c+=parseInt(f[0],10),d+=parseInt(f[1],10),d>=60&&(d-=60,c+=1)}b=zeroLeft(c)+":"+zeroLeft(d),totalWorkedHours.appendChild(document.createTextNode(b))}function isEmpty(a){return""===a||void 0===a||null===a}function isValidHour(a){var b=/^([0-1]?[0-9]|2[0-4]):([0-5][0-9])(:[0-5][0-9])?$/;return b.test(a)}for(var notes=JSON.parse(localStorage.getItem("notes"))||[],totalWorkedHours=document.getElementById("total-worked-hours"),tabItens=document.getElementsByClassName("tab-item"),noteTableBody=document.querySelector("#note-table tbody"),saveEditedNoteBtn=document.getElementById("edit-note-btn"),backNoteBtn=document.getElementById("back-note-btn"),mainContent=document.getElementById("main-content"),i=0;i<tabItens.length;i++)tabItens[i].addEventListener("click",function(){changeTab(this)});!function(){function a(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}var b=document.getElementById("login-btn");document.getElementById("login");b.addEventListener("click",function(){var b=document.getElementById("login-form");isEmpty(b.loginEmail.value)||isEmpty(b.loginPwd.value)?alert("informe o campo e-mail e senha."):a(b.loginEmail.value)?location.href="wdh.html":alert("Informe um e-mail válido.")})}(),function(){function a(){var a=d.noteDate.value,c=a.split("-"),e=new Date(c[0],parseInt(c[1])-1,c[2]),g={id:b(),date:d.noteDate.value,dataString:e,firstEntry:d.firstEntry.value,firstExit:d.firstExit.value,secondEntry:d.secondEntry.value,secondExit:d.secondExit.value,total:calculateTotalWorkedInDay(d.firstEntry.value,d.firstExit.value,d.secondEntry.value,d.secondExit.value)};f.push(g),localStorage.setItem("notes",JSON.stringify(f)),alert("Novo registro adicionado para a data: "+formatDate(g.date)),d.noteDate.value="",d.firstEntry.value="",d.firstExit.value="",d.secondEntry.value="",d.secondExit.value=""}function b(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()+a()+a()+a()+a()}var c=document.getElementById("new-note-btn"),d=document.getElementById("new-note-form"),e=document.getElementsByClassName("note-input"),f=JSON.parse(localStorage.getItem("notes"))||[];c.addEventListener("click",function(){isEmpty(d.noteDate.value)||isEmpty(d.firstEntry.value)||isEmpty(d.firstExit.value)||isEmpty(d.secondEntry.value)||isEmpty(d.secondExit.value)?alert("Todos os campos são obrigatórios."):isValidHour(d.firstEntry.value)&&isValidHour(d.firstExit.value)&&isValidHour(d.secondEntry.value)&&isValidHour(d.secondExit.value)?a():alert("Informe apenas horas válidas (hh:mm)")});for(var g=0;g<e.length;g++)VMasker(e[g]).maskPattern("99:99")}(),function(){function a(){for(var a,c=document.getElementById("start-date").value,d=document.getElementById("end-date").value,e=c.split("-"),f=d.split("-"),g=new Date(e[0],parseInt(e[1],10)-1,e[2]),h=new Date(f[0],parseInt(f[1],10)-1,f[2]),i=[],j=0;j<b.length;j++)a=new Date(b[j].dataString),a<=h&&a>=g&&i.push(b[j]);0!=i.length?addNotesToTable(i):alert("Nenhum registro encontrado entre as datas informadas.")}var b=JSON.parse(localStorage.getItem("notes"))||[],c=document.getElementById("search-btn"),d=document.getElementById("clear-btn");backNoteBtn.addEventListener("click",toogleEditContent),c.addEventListener("click",a),d.addEventListener("click",reloadPage),addNotesToTable(),calculateTotalWorkedAllTheTime(b)}();